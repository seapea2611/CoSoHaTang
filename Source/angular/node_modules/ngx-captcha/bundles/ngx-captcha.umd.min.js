!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/forms"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-captcha",["exports","@angular/core","@angular/forms","@angular/common"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["ngx-captcha"]={},t.ng.core,t.ng.forms,t.ng.common)}(this,(function(t,e,r,n){"use strict";var o=function(){function t(t){this.zone=t,this.windowGrecaptcha="grecaptcha",this.windowOnLoadCallbackProperty="ngx_captcha_onload_callback",this.globalDomain="recaptcha.net",this.defaultDomain="google.com"}return t.prototype.registerCaptchaScript=function(t,e,r,n){var o=this;if(this.grecaptchaScriptLoaded())this.zone.run((function(){r(window[o.windowGrecaptcha])}));else{window[this.windowOnLoadCallbackProperty]=function(){return o.zone.run(r.bind(o,window[o.windowGrecaptcha]))};var a=document.createElement("script");a.innerHTML="",a.src=this.getCaptchaScriptUrl(t,e,n),a.async=!0,a.defer=!0,document.getElementsByTagName("head")[0].appendChild(a)}},t.prototype.cleanup=function(){window[this.windowOnLoadCallbackProperty]=void 0,window[this.windowGrecaptcha]=void 0},t.prototype.grecaptchaScriptLoaded=function(){return!(!window[this.windowOnLoadCallbackProperty]||!window[this.windowGrecaptcha])},t.prototype.getLanguageParam=function(t){return t?"&hl="+t:""},t.prototype.getCaptchaScriptUrl=function(t,e,r){return"https://www."+(t?this.globalDomain:this.defaultDomain)+"/recaptcha/api.js?onload="+this.windowOnLoadCallbackProperty+"&render="+e+this.getLanguageParam(r)},t}();o.decorators=[{type:e.Injectable}],o.ctorParameters=function(){return[{type:e.NgZone}]};var a=function(){function t(t,r,n,o){this.renderer=t,this.zone=r,this.injector=n,this.scriptService=o,this.captchaElemPrefix="ngx_captcha_id_",this.setupCaptcha=!0,this.useGlobalDomain=!1,this.type="image",this.tabIndex=0,this.success=new e.EventEmitter,this.load=new e.EventEmitter,this.reset=new e.EventEmitter,this.ready=new e.EventEmitter,this.error=new e.EventEmitter,this.expire=new e.EventEmitter,this.setupAfterLoad=!1,this.resetCaptchaAfterSuccess=!1,this.isLoaded=!1}return t.prototype.ngAfterViewInit=function(){this.control=this.injector.get(r.NgControl).control},t.prototype.ngAfterViewChecked=function(){this.setupCaptcha&&(this.setupCaptcha=!1,this.setupComponent())},t.prototype.ngOnChanges=function(t){t&&t.hl&&(t.hl.firstChange||t.hl.currentValue===t.hl.previousValue||this.scriptService.cleanup()),t&&t.useGlobalDomain&&(t.useGlobalDomain.firstChange||t.useGlobalDomain.currentValue===t.useGlobalDomain.previousValue||this.scriptService.cleanup()),this.setupCaptcha=!0},t.prototype.getResponse=function(){return this.reCaptchaApi.getResponse(this.captchaId)},t.prototype.getCaptchaId=function(){return this.captchaId},t.prototype.resetCaptcha=function(){var t=this;this.zone.run((function(){t.reCaptchaApi.reset(),t.onChange(void 0),t.onTouched(void 0),t.reset.next()}))},t.prototype.getCurrentResponse=function(){return this.currentResponse},t.prototype.reloadCaptcha=function(){this.setupComponent()},t.prototype.ensureCaptchaElem=function(t){var e=document.getElementById(t);if(!e)throw Error("Captcha element with id '"+t+"' was not found");this.captchaElem=e},t.prototype.renderReCaptcha=function(){var t=this;this.zone.runOutsideAngular((function(){t.captchaId=t.reCaptchaApi.render(t.captchaElemId,t.getCaptchaProperties()),t.ready.next()}))},t.prototype.handleCallback=function(t){var e=this;this.currentResponse=t,this.success.next(t),this.zone.run((function(){e.onChange(t),e.onTouched(t)})),this.resetCaptchaAfterSuccess&&this.resetCaptcha()},t.prototype.getPseudoUniqueNumber=function(){return(new Date).getUTCMilliseconds()+Math.floor(9999*Math.random())},t.prototype.setupComponent=function(){var t=this;this.captchaSpecificSetup(),this.createAndSetCaptchaElem(),this.scriptService.registerCaptchaScript(this.useGlobalDomain,"explicit",(function(e){t.onloadCallback(e)}),this.hl)},t.prototype.onloadCallback=function(t){if(this.reCaptchaApi=t,!this.reCaptchaApi)throw Error("ReCaptcha Api was not initialized correctly");this.isLoaded=!0,this.load.next(),this.renderReCaptcha(),this.setupAfterLoad&&(this.setupAfterLoad=!1,this.setupComponent())},t.prototype.generateNewElemId=function(){return this.captchaElemPrefix+this.getPseudoUniqueNumber()},t.prototype.createAndSetCaptchaElem=function(){var t=this;if(this.captchaElemId=this.generateNewElemId(),!this.captchaElemId)throw Error("Captcha elem Id is not set");if(!this.captchaWrapperElem)throw Error("Captcha DOM element is not initialized");this.captchaWrapperElem.nativeElement.innerHTML="";var e=this.renderer.createElement("div");e.id=this.captchaElemId,this.renderer.appendChild(this.captchaWrapperElem.nativeElement,e),setTimeout((function(){t.captchaElemId&&t.ensureCaptchaElem(t.captchaElemId)}),0)},t.prototype.writeValue=function(t){},t.prototype.registerOnChange=function(t){this.onChange=t},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.prototype.handleErrorCallback=function(){var t=this;this.zone.run((function(){t.onChange(void 0),t.onTouched(void 0)})),this.error.next()},t.prototype.handleExpireCallback=function(){this.expire.next(),this.resetCaptcha()},t}();a.decorators=[{type:e.Directive}],a.ctorParameters=function(){return[{type:e.Renderer2},{type:e.NgZone},{type:e.Injector},{type:o}]},a.propDecorators={siteKey:[{type:e.Input}],useGlobalDomain:[{type:e.Input}],type:[{type:e.Input}],hl:[{type:e.Input}],tabIndex:[{type:e.Input}],success:[{type:e.Output}],load:[{type:e.Output}],reset:[{type:e.Output}],ready:[{type:e.Output}],error:[{type:e.Output}],expire:[{type:e.Output}]};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}Object.create;Object.create;var p={InvisibleReCaptcha:0,ReCaptcha2:1};p[p.InvisibleReCaptcha]="InvisibleReCaptcha",p[p.ReCaptcha2]="ReCaptcha2";var s=function(t){function e(e,r,n,o){var a=t.call(this,e,r,n,o)||this;return a.renderer=e,a.zone=r,a.injector=n,a.scriptService=o,a.size="invisible",a.theme="light",a.badge="bottomright",a.recaptchaType=p.InvisibleReCaptcha,a}return c(e,t),e.prototype.ngOnChanges=function(e){t.prototype.ngOnChanges.call(this,e)},e.prototype.execute=function(){var t=this;this.zone.runOutsideAngular((function(){return t.reCaptchaApi.execute(t.captchaId)}))},e.prototype.captchaSpecificSetup=function(){},e.prototype.getCaptchaProperties=function(){var t=this;return{sitekey:this.siteKey,callback:function(e){return t.zone.run((function(){return t.handleCallback(e)}))},"expired-callback":function(){return t.zone.run((function(){return t.handleExpireCallback()}))},"error-callback":function(){return t.zone.run((function(){return t.handleErrorCallback()}))},badge:this.badge,type:this.type,tabindex:this.tabIndex,size:this.size,theme:this.theme}},e}(a);s.decorators=[{type:e.Component,args:[{selector:"ngx-invisible-recaptcha",template:"\n  <div #captchaWrapperElem></div>",providers:[{provide:r.NG_VALUE_ACCESSOR,useExisting:e.forwardRef((function(){return s})),multi:!0}]}]}],s.ctorParameters=function(){return[{type:e.Renderer2},{type:e.NgZone},{type:e.Injector},{type:o}]},s.propDecorators={theme:[{type:e.Input}],badge:[{type:e.Input}],hl:[{type:e.Input}],captchaWrapperElem:[{type:e.ViewChild,args:["captchaWrapperElem",{static:!1}]}]};var h=function(t){function e(e,r,n,o){var a=t.call(this,e,r,n,o)||this;return a.renderer=e,a.zone=r,a.injector=n,a.scriptService=o,a.windowOnErrorCallbackProperty="ngx_captcha_error_callback",a.windowOnExpireCallbackProperty="ngx_captcha_expire_callback",a.theme="light",a.size="normal",a.recaptchaType=p.ReCaptcha2,a}return c(e,t),e.prototype.ngOnChanges=function(e){t.prototype.ngOnChanges.call(this,e)},e.prototype.ngOnDestroy=function(){window[this.windowOnErrorCallbackProperty]={},window[this.windowOnExpireCallbackProperty]={}},e.prototype.captchaSpecificSetup=function(){this.registerCallbacks()},e.prototype.getCaptchaProperties=function(){var t=this;return{sitekey:this.siteKey,callback:function(e){return t.zone.run((function(){return t.handleCallback(e)}))},"expired-callback":function(){return t.zone.run((function(){return t.handleExpireCallback()}))},"error-callback":function(){return t.zone.run((function(){return t.handleErrorCallback()}))},theme:this.theme,type:this.type,size:this.size,tabindex:this.tabIndex}},e.prototype.registerCallbacks=function(){window[this.windowOnErrorCallbackProperty]=t.prototype.handleErrorCallback.bind(this),window[this.windowOnExpireCallbackProperty]=t.prototype.handleExpireCallback.bind(this)},e}(a);h.decorators=[{type:e.Component,args:[{selector:"ngx-recaptcha2",template:"\n  <div #captchaWrapperElem></div>",providers:[{provide:r.NG_VALUE_ACCESSOR,useExisting:e.forwardRef((function(){return h})),multi:!0}]}]}],h.ctorParameters=function(){return[{type:e.Renderer2},{type:e.NgZone},{type:e.Injector},{type:o}]},h.propDecorators={theme:[{type:e.Input}],size:[{type:e.Input}],hl:[{type:e.Input}],captchaWrapperElem:[{type:e.ViewChild,args:["captchaWrapperElem",{static:!1}]}]};var u=function(){function t(t,e){this.scriptService=t,this.zone=e}return t.prototype.execute=function(t,e,r,n,o){this.executeAsPromise(t,e,n).then(r).catch((function(t){return o?o(t):console.error(t)}))},t.prototype.executeAsPromise=function(t,e,r){var n=this;return new Promise((function(o,a){var i=!(!r||!r.useGlobalDomain);n.scriptService.registerCaptchaScript(i,t,(function(r){n.zone.runOutsideAngular((function(){try{r.execute(t,{action:e}).then((function(t){return n.zone.run((function(){return o(t)}))}))}catch(t){a(t)}}))}))}))},t}();u.decorators=[{type:e.Injectable}],u.ctorParameters=function(){return[{type:o},{type:e.NgZone}]};var l=function(){};l.decorators=[{type:e.NgModule,args:[{imports:[n.CommonModule],declarations:[h,s],providers:[o,u],exports:[h,s]}]}],t.BaseReCaptchaComponent=a,t.InvisibleReCaptchaComponent=s,t.NgxCaptchaModule=l,t.ReCaptcha2Component=h,t.ReCaptchaType=p,t.ReCaptchaV3Service=u,t.ScriptService=o,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-captcha.umd.min.js.map